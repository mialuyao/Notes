# Beaver Triple

## 为什么要用BT

应用场景：使用乘法门的秘密共享中

假设$P_0$的秘密值为$x$，$P_1$的秘密值为$y$，现在需要计算$x*y$，显然，从隐私保护的角度看，直接将自己的秘密值公开再进行计算是非常不安全的，因而采用秘密分享的方法。

将各自秘密值分享拆分$x=x_0+x_1$,$y=y_0+y_1$，$P_0$持有$x_0,y_0$，$P_1$持有$x_1,y_1$；

待求的值$x*y=(x_0+x_1)*(y_0+y_1)=x_0x_1+y_0y_1+x_0y_1+x_1y_0$

显然，前两项通过本地计算即可获得，困难的是后面两项，因此Beaver提出了一种预计算的思想，通过线下的随机预计算工作来降低线上的交互。

## 原理

存在一个第三方$P_2$，产生两个随机数$a,b$，并且由此确定$c=a*b$，利用加法秘密分享的方法将$a,b,c$进行分割，$P_0,P_1$分别得到$(a_0,b_0,c_0)$和$(a_1,b_1,c_1)$，此即称为Beaver Triple，或者乘法三元组。

这里的$P_0,P_1$都只是获得了$a,b,c$的份额，并不知道实际值。

这里有一个比较容易理解的方法（数形结合😂）

<img src="/Users/wangluyao/Library/Application Support/typora-user-images/image-20220314120018546.png" alt="image-20220314120018546" style="zoom: 33%;" />

根据图形

$$x*y=a*b-(a-x)*b-(b-y)*a+(a-x)*(b-y)=c+(x-a)*b+(y-b)*a+(x-a)*(y-b)$$

> 回顾的时候发现一个有意义的地方，$x*y$的表示方法也可以是$a*b-(a-x)*y-(b-y)*x-(a-x)*(b-y)$，但是再往下推的时候就卡住了，像极了明明找到了路但是怎么都走不出去的感觉😢

获得乘法三元组之后，$P_0,P_1$即可在本地计算$x_0-a_0$,$y_0-b_0$,$x_1-a_1$,$y_1-b_1$，并将值进行公开。

> 由于此处进行计算的都是份额，因此公开也不会造成隐私的泄漏。

$P_0$在本地计算$(x_0-a_0)+(x_1-a_1)=x-a$，$P_1$在本地计算$(y_0-b_0)+(y_1-b_1)=y-b$，并进行公开

> 由于$a,b$都是随机值，因此公开$x-a$与$y-b$并不会造成隐私的泄漏。

这样就可以进行最后的总结工作了
$$
\begin{align}
x *y & = a*b-(a-x)*b-(b-y)*a+(a-x)*(b-y)\\
  & = c+(x-a)*b+(y-b)*a+(x-a)*(y-b) \\
  & = c_0 + c_1 +(x-a)*(b_0+b_1)+(y-b)*(a_0+a_1)+(x-a)*(y-b) \\ 
  & = c_0 + (x-a)*b_0 + (y-b)*a_0 + c_1+(x-a)*b_1 + (y-b)* a_1+(x-a)*(y-b)
\end{align}
$$
$P_0$可以在本地计算$c_0 + (x-a)*b_0 + (y-b)*a_0$，也就是$[x*y]_0$

$P_1$可以在本地计算$c_1+(x-a)*b_1 + (y-b)* a_1+(x-a)*(y-b)$也就是$[x*y]_1$

至此完成了$x*y$在$P_0$与$P_1$之间的加法秘密共享。

## 特点

- 三元组完全是由随机数构成的，并且不涉及到计算的真实输入，因此完全可以提前计算出来(offline phase)
- 在真实计算阶段(online phase)，每个乘法门的计算需要消耗一个Beaver三元组，因此需要提前计算出大量的Beaver三元组




# Square Pairs

类似于算术上的BT

两个随机秘密份额$(\left \langle a\right \rangle^A,\left \langle c\right \rangle^A)$，满足$c=a^2$

相较于BT，更适合平方操作


> 徐秋亮, 蒋瀚, & 赵圣楠. (2021). 安全多方计算关键技术：茫然传输协议. 山东大学学报*(*理学版*)*, *56*(10), 61-71. https://kns.cnki.net/kcms/detail/37.1389.N.20210909.1718.002.html 
